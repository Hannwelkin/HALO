
=== EXP06b: LGBM bin + reduced elementwise (from exp05), Â±0.05 bliss cutoff + nested CV ===

Using scheme: CV1
Input  file: /home/hannie/cc_ml/models/results/exp05b_lgbm_bin_sspace_elementwise_featselect_bliss005/elementwise_features_filtered_cv1.csv
Output dir : /home/hannie/cc_ml/models/results/exp06b_lgbm_bin_sspace_elementwise_reduced_nestedcv_bliss005
Loaded reduced df shape: (2976, 1651)
Interaction Type
antagonism    1498
synergy       1478
Name: count, dtype: int64

After filtering to synergy/antagonism: (2976, 1651)
Interaction Type
antagonism    1498
synergy       1478
Name: count, dtype: int64

Total samples: 2976
Reduced feature columns: 1641
========================================================================
CV1 outer fold 1/5 (Drug Pair grouping):
Train size: 2337
Train size fraction: 78.53%
Test size: 639
Test size fraction: 21.47%
Test + Train set: 2976
------------------------------------------------------------------------
========================================================================
CV1 outer fold 2/5 (Drug Pair grouping):
Train size: 2371
Train size fraction: 79.67%
Test size: 605
Test size fraction: 20.33%
Test + Train set: 2976
------------------------------------------------------------------------
========================================================================
CV1 outer fold 3/5 (Drug Pair grouping):
Train size: 2400
Train size fraction: 80.65%
Test size: 576
Test size fraction: 19.35%
Test + Train set: 2976
------------------------------------------------------------------------
========================================================================
CV1 outer fold 4/5 (Drug Pair grouping):
Train size: 2399
Train size fraction: 80.61%
Test size: 577
Test size fraction: 19.39%
Test + Train set: 2976
------------------------------------------------------------------------
========================================================================
CV1 outer fold 5/5 (Drug Pair grouping):
Train size: 2397
Train size fraction: 80.54%
Test size: 579
Test size fraction: 19.46%
Test + Train set: 2976
------------------------------------------------------------------------

########################################################################
########## OUTER FOLD 1/5 ##########
########################################################################


--- Nested CV (outer fold 1) : inner search over 32 configs ---
Best inner-CV ACC (fold 1): 0.728
Best params: {'boosting_type': 'gbdt', 'learning_rate': 0.03, 'max_depth': 3, 'num_leaves': 7, 'min_data_in_leaf': 200, 'feature_fraction': 0.4, 'bagging_fraction': 0.7, 'bagging_freq': 1, 'lambda_l2': 30.001622766378564, 'lambda_l1': 0.0, 'max_bin': 127, 'min_gain_to_split': 0.2}
Finished outer fold 1

########################################################################
########## OUTER FOLD 2/5 ##########
########################################################################


--- Nested CV (outer fold 2) : inner search over 32 configs ---
Best inner-CV ACC (fold 2): 0.732
Best params: {'boosting_type': 'gbdt', 'learning_rate': 0.02, 'max_depth': 3, 'num_leaves': 15, 'min_data_in_leaf': 200, 'feature_fraction': 0.3, 'bagging_fraction': 0.7, 'bagging_freq': 1, 'lambda_l2': 28.155067365025808, 'lambda_l1': 0.5, 'max_bin': 127, 'min_gain_to_split': 0.2}
Finished outer fold 2

########################################################################
########## OUTER FOLD 3/5 ##########
########################################################################


--- Nested CV (outer fold 3) : inner search over 32 configs ---
Best inner-CV ACC (fold 3): 0.723
Best params: {'boosting_type': 'gbdt', 'learning_rate': 0.02, 'max_depth': 3, 'num_leaves': 15, 'min_data_in_leaf': 200, 'feature_fraction': 0.3, 'bagging_fraction': 0.7, 'bagging_freq': 1, 'lambda_l2': 67.66429078348422, 'lambda_l1': 0.5, 'max_bin': 127, 'min_gain_to_split': 0.05}
Finished outer fold 3

########################################################################
########## OUTER FOLD 4/5 ##########
########################################################################


--- Nested CV (outer fold 4) : inner search over 32 configs ---
Best inner-CV ACC (fold 4): 0.734
Best params: {'boosting_type': 'gbdt', 'learning_rate': 0.03, 'max_depth': 3, 'num_leaves': 15, 'min_data_in_leaf': 200, 'feature_fraction': 0.5, 'bagging_fraction': 0.6, 'bagging_freq': 1, 'lambda_l2': 58.37229269759494, 'lambda_l1': 0.0, 'max_bin': 127, 'min_gain_to_split': 0.1}
Finished outer fold 4

########################################################################
########## OUTER FOLD 5/5 ##########
########################################################################


--- Nested CV (outer fold 5) : inner search over 32 configs ---
Best inner-CV ACC (fold 5): 0.718
Best params: {'boosting_type': 'gbdt', 'learning_rate': 0.03, 'max_depth': 3, 'num_leaves': 15, 'min_data_in_leaf': 200, 'feature_fraction': 0.5, 'bagging_fraction': 0.7, 'bagging_freq': 1, 'lambda_l2': 32.90543036330171, 'lambda_l1': 0.0, 'max_bin': 63, 'min_gain_to_split': 0.1}
Finished outer fold 5

========================================================================
=== Summary over 5 outer folds ===
roc_auc_mean=0.8167  roc_auc_std=0.0168
accuracy_mean=0.7341  accuracy_std=0.0154
f1_weighted_mean=0.7343  f1_weighted_std=0.0150
f1_macro_mean=0.7334  f1_macro_std=0.0155
precision_antag_mean=0.7285  precision_antag_std=0.0375
recall_antag_mean=0.7491  recall_antag_std=0.0290
f1_antag_mean=0.7380  f1_antag_std=0.0261
precision_syn_mean=0.7396  precision_syn_std=0.0310
recall_syn_mean=0.7198  recall_syn_std=0.0146
f1_syn_mean=0.7289  f1_syn_std=0.0108

Saved CV metrics summary to: /home/hannie/cc_ml/models/results/exp06b_lgbm_bin_sspace_elementwise_reduced_nestedcv_bliss005/cv_metrics_summary_cv1.csv
========================================================================
Saved mean confusion matrix to: /home/hannie/cc_ml/models/results/exp06b_lgbm_bin_sspace_elementwise_reduced_nestedcv_bliss005/confusion_matrix_cv1_mean.csv
Saved mean confusion matrix plot to: /home/hannie/cc_ml/models/results/exp06b_lgbm_bin_sspace_elementwise_reduced_nestedcv_bliss005/confusion_matrix_cv1_mean.png

Saved aggregated feature importances to: /home/hannie/cc_ml/models/results/exp06b_lgbm_bin_sspace_elementwise_reduced_nestedcv_bliss005/feature_importances_cv1.csv

=== EXP06b DONE ===


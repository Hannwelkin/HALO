
=== EXP02: LGBM bin + S-space + concat + nested CV ===

Using scheme: CV1
Output dir: /home/hannie/cc_ml/models/results/exp02_lgbm_bin_sspace_concat_nestedcv
cc_df: (261, 3202)
ss_df: (103, 129)
combinations_df: (3160, 10)
Full df shape (before filtering): (3160, 6666)
Interaction Type
antagonism    1227
synergy       1222
neutral        711
Name: count, dtype: int64
After filtering to synergy/antagonism: (2449, 6666)
Interaction Type
antagonism    1227
synergy       1222
Name: count, dtype: int64
========================================================================
CV1: Drug Pair grouping:
Train size: 1943
Train size fraction: 79.0
Test size: 506
Test size fraction: 21.0
Test + Train set: 2449
------------------------------------------------------------------------

--- Nested CV: inner search over 32 configs ---
Best inner-CV ACC: 0.615 
Best params: {'boosting_type': np.str_('dart'), 'learning_rate': 0.04, 'max_depth': 3, 'num_leaves': 7, 'min_data_in_leaf': 200, 'feature_fraction': 0.4, 'bagging_fraction': 0.8, 'bagging_freq': 1, 'lambda_l2': 18.616519906714824, 'lambda_l1': 0.0, 'max_bin': 63, 'min_gain_to_split': 0.1}

=== Held-out Test ===
ROC AUC : 0.736
Acc     : 0.662
F1 (w)  : 0.662

Confusion matrix:
 [[171  72]
 [ 99 164]]

Report:
               precision    recall  f1-score   support

  antagonism       0.63      0.70      0.67       243
     synergy       0.69      0.62      0.66       263

    accuracy                           0.66       506
   macro avg       0.66      0.66      0.66       506
weighted avg       0.67      0.66      0.66       506


--- Metrics for Log ---
accuracy_test=0.6621
f1_macro_test=0.6620
f1_weighted_test=0.6618
roc_auc_test=0.7363
precision_antag=0.6333
recall_antag=0.7037
f1_antag=0.6667
precision_syn=0.6949
recall_syn=0.6236
f1_syn=0.6573

=== Overfitting check ===
Train AUC: 0.979 | Test AUC: 0.736
Train Acc: 0.914 | Test Acc: 0.662
Train F1w: 0.914 | Test F1w: 0.662

Saved confusion matrix plot to: /home/hannie/cc_ml/models/results/exp02_lgbm_bin_sspace_concat_nestedcv/confusion_matrix_cv1.png

=== EXP02 DONE ===


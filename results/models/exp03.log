
=== EXP03: LGBM bin + S-space + elementwise similarity + nested CV ===

Using scheme: CV1
Output dir: /home/hannie/cc_ml/models/results/exp03_lgbm_bin_sspace_elementwise_nestedcv
cc_df: (261, 3202)
ss_df: (103, 129)
combinations_df: (3160, 10)
Full df shape (before filtering): (3160, 6666)
Interaction Type
antagonism    1227
synergy       1222
neutral        711
Name: count, dtype: int64
After filtering to synergy/antagonism: (2449, 6666)
Interaction Type
antagonism    1227
synergy       1222
Name: count, dtype: int64
========================================================================
CV1: Drug Pair grouping:
Train size: 1943
Train size fraction: 79.0
Test size: 506
Test size fraction: 21.0
Test + Train set: 2449
------------------------------------------------------------------------

--- Nested CV: inner search over 32 configs ---
Best inner-CV ACC: 0.684 
Best params: {'boosting_type': np.str_('dart'), 'learning_rate': 0.05, 'max_depth': 3, 'num_leaves': 15, 'min_data_in_leaf': 200, 'feature_fraction': 0.3, 'bagging_fraction': 0.8, 'bagging_freq': 1, 'lambda_l2': 26.406272423042086, 'lambda_l1': 0.1, 'max_bin': 63, 'min_gain_to_split': 0.05}

=== Held-out Test ===
ROC AUC : 0.786
Acc     : 0.706
F1 (w)  : 0.705

Confusion matrix:
 [[165  78]
 [ 71 192]]

Report:
               precision    recall  f1-score   support

  antagonism       0.70      0.68      0.69       243
     synergy       0.71      0.73      0.72       263

    accuracy                           0.71       506
   macro avg       0.71      0.70      0.70       506
weighted avg       0.71      0.71      0.71       506


--- Metrics for Log ---
accuracy_test=0.7055
f1_macro_test=0.7047
f1_weighted_test=0.7053
roc_auc_test=0.7861
precision_antag=0.6992
recall_antag=0.6790
f1_antag=0.6889
precision_syn=0.7111
recall_syn=0.7300
f1_syn=0.7205

=== Overfitting check ===
Train AUC: 0.987 | Test AUC: 0.786
Train Acc: 0.924 | Test Acc: 0.706
Train F1w: 0.924 | Test F1w: 0.705

Saved confusion matrix plot to: /home/hannie/cc_ml/models/results/exp03_lgbm_bin_sspace_elementwise_nestedcv/confusion_matrix_cv1.png

=== EXP03 DONE ===



=== EXP06: LGBM bin + reduced elementwise (from exp05) + nested CV ===

Using scheme: CV1
Input  file: /home/hannie/cc_ml/models/results/exp05_lgbm_bin_sspace_elementwise_featselect/elementwise_features_filtered_cv1.csv
Output dir : /home/hannie/cc_ml/models/results/exp06_lgbm_bin_sspace_elementwise_reduced_nestedcv
Loaded reduced df shape: (2449, 1658)
Interaction Type
antagonism    1227
synergy       1222
Name: count, dtype: int64

After filtering to synergy/antagonism: (2449, 1658)
Interaction Type
antagonism    1227
synergy       1222
Name: count, dtype: int64

Total samples: 2449
Reduced feature columns: 1648
========================================================================
CV1: Drug Pair grouping:
Train size: 1943
Train size fraction: 79.0
Test size: 506
Test size fraction: 21.0
Test + Train set: 2449
------------------------------------------------------------------------

--- Nested CV: inner search over 32 configs ---
Best inner-CV ACC: 0.743 
Best params: {'boosting_type': 'gbdt', 'learning_rate': 0.03, 'max_depth': 3, 'num_leaves': 7, 'min_data_in_leaf': 200, 'feature_fraction': 0.5, 'bagging_fraction': 0.7, 'bagging_freq': 1, 'lambda_l2': 38.95028260418918, 'lambda_l1': 0.1, 'max_bin': 63, 'min_gain_to_split': 0.05}

=== Held-out Test ===
ROC AUC : 0.780
Acc     : 0.702
F1 (w)  : 0.701

Confusion matrix:
 [[163  80]
 [ 71 192]]

Report:
               precision    recall  f1-score   support

  antagonism       0.70      0.67      0.68       243
     synergy       0.71      0.73      0.72       263

    accuracy                           0.70       506
   macro avg       0.70      0.70      0.70       506
weighted avg       0.70      0.70      0.70       506


--- Metrics for Log ---
accuracy_test=0.7016
f1_macro_test=0.7006
f1_weighted_test=0.7013
roc_auc_test=0.7800
precision_antag=0.6966
recall_antag=0.6708
f1_antag=0.6834
precision_syn=0.7059
recall_syn=0.7300
f1_syn=0.7178

=== Overfitting check ===
Train AUC: 0.987 | Test AUC: 0.78
Train Acc: 0.924 | Test Acc: 0.702
Train F1w: 0.924 | Test F1w: 0.701

Saved confusion matrix plot to: /home/hannie/cc_ml/models/results/exp06_lgbm_bin_sspace_elementwise_reduced_nestedcv/confusion_matrix_cv1.png

=== EXP06 DONE ===


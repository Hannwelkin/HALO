
=== EXP08: LGBM regression + reduced elementwise (from exp05) + nested CV ===

Using scheme: CV1
Input  file: /home/hannie/cc_ml/models/results/exp05_lgbm_bin_sspace_elementwise_featselect/elementwise_features_filtered_cv1_full.csv
Output dir : /home/hannie/cc_ml/models/results/exp08_lgbm_regr_sspace_elementwise_reduced_nestedcv
Loaded df shape: (3160, 1658)
After dropping NaN Bliss Score: (3160, 1658)

Reduced feature columns: 1648
Total samples: 3160
========================================================================
CV1: Drug Pair grouping:
Train size: 2535
Train size fraction: 80.0
Test size: 625
Test size fraction: 20.0
Test + Train set: 3160
------------------------------------------------------------------------

--- Nested CV: inner search over 32 configs ---
Best inner-CV RMSE: 0.2213 
Best params: {'boosting_type': np.str_('gbdt'), 'learning_rate': 0.05, 'max_depth': 3, 'num_leaves': 15, 'min_data_in_leaf': 100, 'feature_fraction': 0.4, 'bagging_fraction': 0.6, 'bagging_freq': 1, 'lambda_l2': 26.587698853105525, 'lambda_l1': 0.5, 'max_bin': 127, 'min_gain_to_split': 0.05}

=== Held-out Test (Regression) ===
RMSE      : 0.2099
MAE       : 0.1612
R^2       : 0.2676
Spearman ρ: 0.4706
Pearson r : 0.5208

=== Overfitting check (Regression) ===
Train RMSE: 0.1243 | Test RMSE: 0.2099
Train MAE : 0.0889 | Test MAE : 0.1612
Train R^2 : 0.7742 | Test R^2 : 0.2676
Train ρ   : 0.8536 | Test ρ   : 0.4706
Train r   : 0.8799 | Test r   : 0.5208

Saved Pred vs True plot to: /home/hannie/cc_ml/models/results/exp08_lgbm_regr_sspace_elementwise_reduced_nestedcv/pred_vs_true_cv1.png

=== EXP08 DONE ===

